
<html>
  <head>
    <title>Climate Quiz WPSU</title>
  </head>
  <body>
    <canvas id="canvas" width="1000" height="563"></canvas>

    <script src="https://unpkg.com/@rive-app/canvas@2.10.3"></script>
    <script>
       
      
	  var score = 0;
	  var index = 0;
	  var points = 0
	
	  function loadtext() {
		  
		  report_score = score.toString();
		  r.setTextRunValue("score", report_score);
		  
		  if (index == 0) {
			r.setTextRunValue("intro", "Hi there! My name is Carmen, and this is my farm.\n\nCan you help me make it more sustainable?");
          	r.setTextRunValue("carmen_questions", "My corn is wilting in the field! There has to be a more efficient way to water the crop.\n\nWhich method should I use?");
			r.setTextRunValue("bt_text01", "Flood Irrigation");          	
		  	r.setTextRunValue("bt_text02", "Drought-Resistant Vegetables");
			r.setTextRunValue("bt_text03", "Precision Irrigation");          	
		  	r.setTextRunValue("q1_bt1_description","I remember seeing my grandpa flood the fields when I was younger.\nIt seems simple - just open the canal and let the water flow.");
		  	r.setTextRunValue("q1_bt2_description","These corn varieties require less water to thrive but may have slightly lower yields.");
		 	r.setTextRunValue("q1_bt3_description","This technology uses GPS and data to deliver water exactly where it's\nneeded, minimizing waste. (This may be the most expensive option).");
	  		}

  		  if (index == 1) {
           	r.setTextRunValue("carmen_questions", "I need to power my farm with an environmentally friendly energy source, and maintain profits.\nCan you help me choose a way to keep the lights on and power our equipment?");
			r.setTextRunValue("bt_text01", "Develop a Biogas \nDigester Co-operative");
			r.setTextRunValue("bt_text02", "Combine Solar and \nBattery Storage");
			r.setTextRunValue("bt_text03", "Stick with Grid Power");
  		  	r.setTextRunValue("q1_bt1_description","This is the most familiar option, but you've heard concerns about the environmental impact of relying on traditional power sources.");
  		  	r.setTextRunValue("q1_bt2_description","Solar panels can generate clean energy, but you'll need a battery storage system to capture and use the power at night or on cloudy days.");
  		 	r.setTextRunValue("q1_bt3_description","Working with neighboring farms allows us to share costs and benefits of a biogas system, creating a sustainable energy source for multiple farms.");
  	  		}

		  if (index == 2) {
           	r.setTextRunValue("carmen_questions", "I noticed my yields are not what they were last year.\nA cooperative extension tested the soil and there were some deficiencies. How can I improve my soil and profits?");
			r.setTextRunValue("bt_text01", "Apply Synthetic Fertilizers");
			r.setTextRunValue("bt_text02", "Purchase Compost");
			r.setTextRunValue("bt_text03", "Compost Farm Waste");
  		  	r.setTextRunValue("q1_bt1_description","These are readily available and provide a quick boost to soil nutrients. However, overuse can harm soil ecology and pollute waterways.");
  		  	r.setTextRunValue("q1_bt2_description","Adding compost is an easy way to add organic matter and beneficial microbes, but buying it can be expensive.");
  		 	r.setTextRunValue("q1_bt3_description","Turning manure and leftover plant material into compost is a free way to add organic matter, but it requires a lot of space and time.");
  	  		}
		  
		  
	  }
	  
	  
      const r = new rive.Rive({
		  
        src: "assets/wpsu_quiz.riv",
        canvas: document.getElementById("canvas"),
		//shouldDisableRiveListeners: true,
        autoplay: true,
        stateMachines: "main",
		  
        onLoad: () => {
		  
			loadtext (index);
		  //const inputs = r.stateMachineInputs('main')
		  //const low = inputs.find((i) => i.name === "low");
		  //const mid = inputs.find((i) => i.name === "mid");
		  //const high = inputs.find((i) => i.name === "high");
          //r.resizeDrawingSurfaceToCanvas();\
          
        },

      });
	  
	  function onRiveEventRecieved(riveEvent) {
		      const eventData = riveEvent.data;
		      switch (eventData.name) {
			  	case "but1onClick":
					if (index == 0) {
						points = 5;
	  					r.setTextRunValue("carmen_questions", "This should help a little, but not much...");
					}

				case "but1onClick":
					if (index == 1) {
						points = 5;
	  					r.setTextRunValue("carmen_questions", "This should help a little, but not much...");
					}

				case "but1onClick":
					if (index == 2) {
						points = 5;
	  					r.setTextRunValue("carmen_questions", "This should help a little, but not much...");
					}
		          break;
		        case "but2onClick":
					if (index == 0) {
						points = 10;
				  	 	r.setTextRunValue("carmen_questions", "This is a great idea! Thank you for your help!");
				     }

				case "but2onClick":
					if (index == 1) {
						points = 10;
				  	 	r.setTextRunValue("carmen_questions", "This is a great idea! Thank you for your help!");
				     }

				case "but2onClick":
					if (index == 2) {
						points = 10;
				  	 	r.setTextRunValue("carmen_questions", "This is a great idea! Thank you for your help!");
				     }
		          break;
		        case "but3onClick":
					if (index == 0) {
						points = 15;
				  		r.setTextRunValue("carmen_questions", "This is a good idea, but it's so expensive!");
					}

				case "but3onClick":
					if (index == 1) {
						points = 15;
				  		r.setTextRunValue("carmen_questions", "This is a good idea, but it's so expensive!");
					}

				case "but3onClick":
					if (index == 2) {
						points = 15;
				  		r.setTextRunValue("carmen_questions", "This is a good idea, but it's so expensive!");
					}
		          break;				
		        

	        	case "question02":
		            index = index + 1;
					score = score + points;
					loadtext();			
	          	  break;

				case "question03":
		            index = index + 1;
					score = score + points;
					loadtext();			
	          	  break;

				case "reset":
					const inputs = r.stateMachineInputs('main');
					const resetButtons = inputs.find(i => i.name === 'reset');
					resetButtons.fire();
				  break;

		        default:
		          console.log("Unhandled event");
		          console.log(riveEvent);
		          break;
		      }	
	  }
	  r.on(rive.EventType.RiveEvent, onRiveEventRecieved);    
    
      
    </script>
  </body>
</html>