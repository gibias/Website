
<html>
  <head>
    <title>Climate Quiz WPSU</title>
  </head>
  <body>
    <canvas id="canvas" width="1000" height="563"></canvas>

    <script src="https://unpkg.com/@rive-app/canvas@2.10.3"></script>
    <script>       
      
	  var score = 0;
	  var index = 0;
	  var points = 0
	
	  function loadtext() {
		  
		  report_score = score.toString();
		  r.setTextRunValue("score", report_score);
		  
		  if (index == 0) {
			r.setTextRunValue("intro", "Hi there! My name is Carmen, and this is my farm.\n\nCan you help me make it more sustainable?");
          	r.setTextRunValue("carmen_questions", "My corn is wilting in the field! There has to be a more efficient way to water the crop.\n\nWhich method should I use?");
			r.setTextRunValue("bt_text01", "Flood Irrigation");          	
		  	r.setTextRunValue("bt_text02", "Drought-Resistant Vegetables");
			r.setTextRunValue("bt_text03", "Precision Irrigation");          	
		  	r.setTextRunValue("q1_bt1_description","I remember seeing my grandpa flood the fields when I was younger.\nIt seems simple - just open the canal and let the water flow.");
		  	r.setTextRunValue("q1_bt2_description","These corn varieties require less water to thrive but may have slightly lower yields.");
		 	r.setTextRunValue("q1_bt3_description","This technology uses GPS and data to deliver water exactly where it's\nneeded, minimizing waste. (This may be the most expensive option).");
	  		}

  		  if (index == 1) {
           	r.setTextRunValue("carmen_questions", "I need to power my farm with an environmentally friendly energy source, and maintain profits.\nCan you help me choose a way to keep the lights on and power our equipment?");
			r.setTextRunValue("bt_text02", "Develop a Biogas \nDigester Co-operative");
			r.setTextRunValue("bt_text01", "Combine Solar and \nBattery Storage");
			r.setTextRunValue("bt_text03", "Stick with Grid Power");
  		  	r.setTextRunValue("q1_bt2_description","This is the most familiar option, but you've heard concerns about the environmental impact of relying on traditional power sources.");
  		  	r.setTextRunValue("q1_bt1_description","Solar panels can generate clean energy, but you'll need a battery storage system to capture and use the power at night or on cloudy days.");
  		 	r.setTextRunValue("q1_bt3_description","Working with neighboring farms allows us to share costs and benefits of a biogas system, creating a sustainable energy source for multiple farms.");
  	  		}

		  if (index == 2) {
           	r.setTextRunValue("carmen_questions", "I noticed my yields are not what they were last year.\nA cooperative extension tested the soil and there were some deficiencies. How can I improve my soil and profits?");
			r.setTextRunValue("bt_text01", "Apply Synthetic Fertilizers");
			r.setTextRunValue("bt_text02", "Purchase Compost");
			r.setTextRunValue("bt_text03", "Compost Farm Waste");
  		  	r.setTextRunValue("q1_bt1_description","These are readily available and provide a quick boost to soil nutrients. However, overuse can harm soil ecology and pollute waterways.");
  		  	r.setTextRunValue("q1_bt2_description","Adding compost is an easy way to add organic matter and beneficial microbes, but buying it can be expensive.");
  		 	r.setTextRunValue("q1_bt3_description","Turning manure and leftover plant material into compost is a free way to add organic matter, but it requires a lot of space and time.");
  	  		}

		if (index == 3) {
           	r.setTextRunValue("carmen_questions", "I noticed European Corn Borer destroying my sweet corn crop.\nHow can I keep my corn safe from the insects?");
			r.setTextRunValue("bt_text03", "Apply broad spectrum\npesticide");
			r.setTextRunValue("bt_text02", "Trap Crops");
			r.setTextRunValue("bt_text01", "Crop Rotation");
  		  	r.setTextRunValue("q1_bt3_description","These are readily available and rapidly reduce pest populations, but they are expensive, and can harm the ecosystem and pollute waterways.");
  		  	r.setTextRunValue("q1_bt2_description","Planting another crop to attract pests away from the main crop encourages beneficial insects in the area.");
  		 	r.setTextRunValue("q1_bt1_description","Crop rotation disrupts the insect life cycle with non-host crops. It also enhances soil health and promotes biodiversity.");
  	  		}

		if (index == 4) {
           	r.setTextRunValue("carmen_questions", "I'm interested in using the trees on my land.\nWhat are some ways I can use agroforestry to make my farm more sustainable and do my part to fight climate change?");
			r.setTextRunValue("bt_text02", "Windbreaks");
			r.setTextRunValue("bt_text01", "Alley Cropping");
			r.setTextRunValue("bt_text03", "Forest Farming");
  		  	r.setTextRunValue("q1_bt2_description","Carmen could remove some of her trees and leave the remainder to be used to shelter crops, buildings and provide space for wildlife.");
  		  	r.setTextRunValue("q1_bt1_description","Alley cropping is planting rows of trees and shrubs alongside corps to provide shade and wind protection.");
  		 	r.setTextRunValue("q1_bt3_description","Also called multistory cropping, forest farming is a way of growing herbal, food, or decorative crops under a forest canopy.");
  	  		}

		  if (index == 5) {
           	r.setTextRunValue("carmen_questions", "Thank you for your help!\nYour final score was " + report_score + " out of 100!\n\nWould you like to play again?");
			}	  
		  
	  }	  
	  
      const r = new rive.Rive({
		  
        src: "assets/wpsu_quiz.riv",
        canvas: document.getElementById("canvas"),
		//shouldDisableRiveListeners: true,
        autoplay: true,
        stateMachines: "main",
		  
        onLoad: () => {
		  
			loadtext (index);
		  //const inputs = r.stateMachineInputs('main')
		  //const low = inputs.find((i) => i.name === "low");
		  //const mid = inputs.find((i) => i.name === "mid");
		  //const high = inputs.find((i) => i.name === "high");
          //r.resizeDrawingSurfaceToCanvas();\
          
        },

      });
	  
	  function onRiveEventRecieved(riveEvent) {
		      const eventData = riveEvent.data;
		      switch (eventData.name) {
			  	case "but1onClick":
					if (index == 0) {
						points = 10;
	  					r.setTextRunValue("carmen_questions", "This is the least efficient option. It wastes a lot of water through evaporation and runoff, especially on uneven terrain. The soil may become waterlogged, hindering root growth.");
					}
				case "but1onClick":
					if (index == 1) {
						points = 15;
	  					r.setTextRunValue("carmen_questions", "This is the cheapest option initially, but the long-term cost depends on electricity prices and your farm's energy consumption.");
					}
				case "but1onClick":
					if (index == 2) {
						points = 10;
	  					r.setTextRunValue("carmen_questions", "This is the fastest option, but overuse can lead to negative environmental consequences.");
					}
				case "but1onClick":
					if (index == 3) {
						points = 20;
	  					r.setTextRunValue("carmen_questions", "This is the fastest option, but can lead to negative environmental consequences.");
					}
				case "but1onClick":
					if (index == 4) {
						points = 15;
	  					r.setTextRunValue("carmen_questions", "Trees can provide microclimates for wildlife, but cutting down trees can have effects on carbon dioxide in the atmosphere.");
					}
		          break;

		        case "but2onClick":
					if (index == 0) {
						points = 20;
				  	 	r.setTextRunValue("carmen_questions", "This is a good balance between water conservation and yield. While the yield may be slightly lower, it minimizes risks associated with drought conditions.");
				     }
				case "but2onClick":
					if (index == 1) {
						points = 10;
				  	 	r.setTextRunValue("carmen_questions", "This is a reliable and sustainable option, but the cost of batteries can be significant.");
				     }
				case "but2onClick":
					if (index == 2) {
						points = 15;
				  	 	r.setTextRunValue("carmen_questions", "This is a convenient option, but the cost can add up quickly.");
				     }
				case "but2onClick":
					if (index == 3) {
						points = 15;
				  	 	r.setTextRunValue("carmen_questions", "This encourages biodiversity, but is labor intensive and difficult to manage as trap crops can become infested and serve as source of the pests.");
				     }
				case "but2onClick":
					if (index == 4) {
						points = 10;
				  	 	r.setTextRunValue("carmen_questions", "The trees can provide additional income through timber or fruit production, but Carmen would have to cut down some of the trees she has.");
				     }
		          break;

		        case "but3onClick":
					if (index == 0) {
						points = 15;
				  		r.setTextRunValue("carmen_questions", "This is the most water-efficient option, but the cost may be prohibitive for some farmers.");
					}
				case "but3onClick":
					if (index == 1) {
						points = 20;
				  		r.setTextRunValue("carmen_questions", "This maximizes resource utilization while fostering community collaboration, but requires cooperation and long-term commitment from participants.");
					}
				case "but3onClick":
					if (index == 2) {
						points = 20;
				  		r.setTextRunValue("carmen_questions", "This is a free way to create nutrient-rich compost, but it requires upfront effort and space management.");
					}
				case "but3onClick":
					if (index == 3) {
						points = 10;
				  		r.setTextRunValue("carmen_questions", "This option reduces the reliance on pesticides, but also requires significant management and planning. It may also take a while to see the effects.");
					}
				case "but3onClick":
					if (index == 4) {
						points = 20;
				  		r.setTextRunValue("carmen_questions", "This option makes use of the trees already on Carmenâ€™s land and adds an extra source of income.");
					}
		          break;				
		        

				  case "question02":
		            index = index + 1;
					score = score + points;
					loadtext();			
	          	  break;

				case "question03":
		            index = index + 1;
					score = score + points;
					loadtext();			
	          	  break;
				  
				case "question04":
		            index = index + 1;
					score = score + points;
					loadtext();			
	          	  break;

				case "question05":
		            index = index + 1;
					score = score + points;
					loadtext();			
	          	  break;	

				case "endScreen":
		            index = index + 1;
					score = score + points;
					loadtext();			
	          	  break;	

				case "restart":
		            index = 0;
					score = 0;
					loadtext();			
	          	  break;		

		        default:
		          console.log("Unhandled event");
		          console.log(riveEvent);
		          break;
		      }	
	  }
	  r.on(rive.EventType.RiveEvent, onRiveEventRecieved);      
      
    </script>
  </body>
</html>